---
title: 案例研究-HoloTour
description: HoloTour for Microsoft HoloLens 为世界各地的图标位置提供了沉浸式三维个人教程。 此案例研究将指导您捕获和创建用于 HoloTour 的内容。
author: dannyaskew
ms.author: daaske
ms.date: 03/21/2018
ms.topic: article
keywords: HoloTour、HoloLens、Windows Mixed Reality
ms.openlocfilehash: 9908327a1b8e70eef73d3f98adb7c75615e8e098
ms.sourcegitcommit: 09599b4034be825e4536eeb9566968afd021d5f3
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/03/2020
ms.locfileid: "91677319"
---
# <a name="case-study---holotour"></a><span data-ttu-id="3b397-105">案例研究-HoloTour</span><span class="sxs-lookup"><span data-stu-id="3b397-105">Case study - HoloTour</span></span>

<span data-ttu-id="3b397-106">HoloTour for Microsoft HoloLens 为世界各地的图标位置提供了沉浸式三维个人教程。</span><span class="sxs-lookup"><span data-stu-id="3b397-106">HoloTour for Microsoft HoloLens provides immersive 3D personal tours of iconic locations around the world.</span></span> <span data-ttu-id="3b397-107">随着设计人员、艺术家、制造者、音频设计人员、开发人员、音频设计人员和开发人员的开发人员的研究，为众所周知的位置创建 convincingly 的真实三维呈现会使创意和技术赏识的独特融合。</span><span class="sxs-lookup"><span data-stu-id="3b397-107">As the designers, artists, producers, audio designers, and developers working on this project found out, creating a convincingly real 3D rendering of a well-known location takes a unique blend of creative and technological wizardry.</span></span> <span data-ttu-id="3b397-108">此案例研究将指导您捕获和创建用于 HoloTour 的内容。</span><span class="sxs-lookup"><span data-stu-id="3b397-108">This case study will walk through the process of capturing and creating the content used for HoloTour.</span></span>

## <a name="the-tech"></a><span data-ttu-id="3b397-109">技术人员</span><span class="sxs-lookup"><span data-stu-id="3b397-109">The tech</span></span>

<span data-ttu-id="3b397-110">通过 HoloTour，我们想让人们能够访问世界上一些最精彩的目标，例如 [刻录的 Machu Picchu](https://en.wikipedia.org/wiki/Machu_Picchu) ，或在意大利的现代时代 [Piazza Navona](https://en.wikipedia.org/wiki/Piazza_Navona) ，直接从他们自己的客厅。</span><span class="sxs-lookup"><span data-stu-id="3b397-110">With HoloTour, we wanted to make it possible for people to visit some of the world’s most amazing destinations—like the [ruins of Machu Picchu](https://en.wikipedia.org/wiki/Machu_Picchu) in Peru or the modern day [Piazza Navona](https://en.wikipedia.org/wiki/Piazza_Navona) in Italy—right from their own living rooms.</span></span> <span data-ttu-id="3b397-111">我们的团队使其成为 "让你感到非常 HoloTour" 的目标。</span><span class="sxs-lookup"><span data-stu-id="3b397-111">Our team made it the goal of HoloTour to “make you feel like you’re really there.”</span></span> <span data-ttu-id="3b397-112">不仅仅是图片或视频。</span><span class="sxs-lookup"><span data-stu-id="3b397-112">The experience needed to be more than just pictures or videos.</span></span> <span data-ttu-id="3b397-113">通过利用 HoloLens 的独特显示、跟踪和音频技术，我们认为我们可以将你与其他位置进行传输。</span><span class="sxs-lookup"><span data-stu-id="3b397-113">By leveraging the unique display, tracking, and audio technology of HoloLens we believed we could virtually transport you to another place.</span></span> <span data-ttu-id="3b397-114">我们需要捕获我们访问的每个位置的堪萨斯州、声音和三维几何，然后在应用程序中重新创建。</span><span class="sxs-lookup"><span data-stu-id="3b397-114">We would need to capture the sights, sounds, and three-dimensional geometry of every location we visited and then recreate that within our app.</span></span>

<span data-ttu-id="3b397-115">为此，我们需要一个带有定向音频捕获的360的相机装置。</span><span class="sxs-lookup"><span data-stu-id="3b397-115">In order to do this, we needed a 360° camera rig with directional audio capture.</span></span> <span data-ttu-id="3b397-116">它需要在极高的分辨率下进行捕获，以便在 HoloLens 上播放时，该素材看起来很清晰，并且需要将相机放置在一起，以便最大程度地减少对项目的装订。</span><span class="sxs-lookup"><span data-stu-id="3b397-116">It needed to capture at extremely high resolution, so that the footage would look crisp when played back on a HoloLens and the cameras would need to be positioned close together in order to minimize stitching artifacts.</span></span> <span data-ttu-id="3b397-117">我们希望获得全部的球状，而不只是在范围内，而是在您的上方和下方。</span><span class="sxs-lookup"><span data-stu-id="3b397-117">We wanted full spherical coverage, not just along the horizon, but above and below you as well.</span></span> <span data-ttu-id="3b397-118">远程测试机组还需要是可移植的，以便我们可以将其全部放在世界各地。</span><span class="sxs-lookup"><span data-stu-id="3b397-118">The rig also needed to be portable so that we could take it all over the world.</span></span> <span data-ttu-id="3b397-119">我们评估了现成的可用选项，并且认识到它们只是由于解决方案、成本或大小而没有太好。</span><span class="sxs-lookup"><span data-stu-id="3b397-119">We evaluated available off-the-shelf options and realized they simply weren’t good enough to realize our vision – either because of resolution, cost, or size.</span></span> <span data-ttu-id="3b397-120">如果找不到满足我们需求的相机远程测试机组，就必须自己构建。</span><span class="sxs-lookup"><span data-stu-id="3b397-120">If we couldn’t find a camera rig that satisfied our needs, we would have to build one ourselves.</span></span>

### <a name="building-the-rig"></a><span data-ttu-id="3b397-121">构建远程测试机组</span><span class="sxs-lookup"><span data-stu-id="3b397-121">Building the rig</span></span>

<span data-ttu-id="3b397-122">第一个版本（从 cardboard、Velcro、管道磁带和 14 GoPro 相机进行）是 MacGyver 为你自豪的东西。</span><span class="sxs-lookup"><span data-stu-id="3b397-122">The first version—made from cardboard, Velcro, duct tape, and 14 GoPro cameras—was something MacGyver would have been proud of.</span></span> <span data-ttu-id="3b397-123">在查看从低端解决方案到自定义制造的工作区的所有内容之后，GoPro 摄像头最终是最佳选项，因为它们的价格较小且价格合理，并且具有易于使用的内存存储。</span><span class="sxs-lookup"><span data-stu-id="3b397-123">After reviewing everything from low-end solutions to custom manufactured rigs, GoPro cameras were ultimately the best option for us because they were small, affordable, and had easy-to-use memory storage.</span></span> <span data-ttu-id="3b397-124">小型外形规格尤为重要，因为它允许我们将相机相对靠近一小，这就是摄像机之间的距离越小，就越小。</span><span class="sxs-lookup"><span data-stu-id="3b397-124">The small form factor was especially important because it allowed us to place cameras fairly close together—the smaller the distance between cameras, the smaller the stitching artifacts will be.</span></span> <span data-ttu-id="3b397-125">我们独特的相机排列使我们能够获得全部球体 *覆盖面，并使* 其具有足够的重叠，以便在处理过程中智能地对齐相机和平滑某些项目。</span><span class="sxs-lookup"><span data-stu-id="3b397-125">Our unique camera arrangement allowed us to get full sphere coverage *plus* enough overlap to intelligently align cameras and smooth out some artifacts during the stitching process.</span></span>

<span data-ttu-id="3b397-126">在 HoloLens 上利用 [空间音效](../design/spatial-sound.md) 功能对创建 convincingly 的真正沉浸式体验至关重要。</span><span class="sxs-lookup"><span data-stu-id="3b397-126">Taking advantage of the [spatial sound](../design/spatial-sound.md) capabilities on HoloLens is critical to creating a convincingly real immersive experience.</span></span> <span data-ttu-id="3b397-127">我们使用了位于其上的照相机下的四位麦克风阵列，它会在四个方向上从摄像机位置捕获声音，为我们提供了足够的信息在我们的场景中创建空间声音。</span><span class="sxs-lookup"><span data-stu-id="3b397-127">We used a four-microphone array situated beneath the cameras on the tripod, which would capture sound from the location of our camera in four directions, giving us enough information to create spatial sounds in our scenes.</span></span>

![我们在 Pantheon 外为与设置了360°相机远程测试机组。](images/camera-pantheon-200px.png)

<span data-ttu-id="3b397-129">我们在 Pantheon 外为与设置了360°相机远程测试机组。</span><span class="sxs-lookup"><span data-stu-id="3b397-129">Our 360° camera rig set up for filming outside the Pantheon.</span></span> 


<span data-ttu-id="3b397-130">我们通过将自制的远程测试机组置于西雅图附近条的凸缘，并捕获徒步顶部的风景，对其进行了测试。</span><span class="sxs-lookup"><span data-stu-id="3b397-130">We tested out our homemade rig by taking it up to Rattlesnake Ridge near Seattle, capturing the scenery at the top of the hike.</span></span> <span data-ttu-id="3b397-131">结果，尽管它比你目前在 HoloTour 中看到的位置显著得多，但我们相信，我们的远程测试机组设计确实足以使你感到满意。</span><span class="sxs-lookup"><span data-stu-id="3b397-131">The result, though significantly less polished than the locations you see in HoloTour today, gave us confidence that our rig design was good enough to make you feel like you’re really there.</span></span>

<span data-ttu-id="3b397-132">我们已将从 Velcro 和 cardboard 的远程测试升级到3D 打印的摄像头架，并购买了 GoPro 相机的外部电池组，以简化电池管理。</span><span class="sxs-lookup"><span data-stu-id="3b397-132">We upgraded our rig from Velcro and cardboard to a 3D-printed camera housing and bought external battery packs for the GoPro cameras to simplify battery management.</span></span> <span data-ttu-id="3b397-133">然后，我们进行了更广泛的测试，将其向下传播到旧金山，以创建城市海岸和图标黄金入口桥的小型教程。</span><span class="sxs-lookup"><span data-stu-id="3b397-133">We then did a more extensive test, traveling down to San Francisco to create a miniature tour of the city’s coast and the iconic Golden Gate bridge.</span></span> <span data-ttu-id="3b397-134">此照相机 rig 是我们在 HoloTour 中所访问位置的大多数捕获的功能。</span><span class="sxs-lookup"><span data-stu-id="3b397-134">This camera rig is what we used for most of our captures of the locations you visit in HoloTour.</span></span>

![360°相机远程测试机组与 in Machu Picchu。](images/camera-machu-pichu-500px.png)

<span data-ttu-id="3b397-136">360°相机远程测试机组与 in Machu Picchu。</span><span class="sxs-lookup"><span data-stu-id="3b397-136">The 360° camera rig filming in Machu Picchu.</span></span> 

## <a name="behind-the-scenes"></a><span data-ttu-id="3b397-137">幕后</span><span class="sxs-lookup"><span data-stu-id="3b397-137">Behind the scenes</span></span>

<span data-ttu-id="3b397-138">在与之前，我们需要找出要在虚拟教程中包括的位置。</span><span class="sxs-lookup"><span data-stu-id="3b397-138">Before filming, we needed to figure out which locations we wanted to include on our virtual tour.</span></span> <span data-ttu-id="3b397-139">罗马是我们打算交付的第一个位置，我们希望能够正确地进行操作，因此我们决定提前进行 scouting。</span><span class="sxs-lookup"><span data-stu-id="3b397-139">Rome was the first location we intended to ship and we wanted to get it right, so we decided to do a scouting trip in advance.</span></span> <span data-ttu-id="3b397-140">我们发送了六名人员（包括艺术家、设计人员和制造者）的团队，以供他人访问我们正在考虑的站点。</span><span class="sxs-lookup"><span data-stu-id="3b397-140">We sent a team of six people—including artists, designers, and producers—for an in-person visit to the sites we were considering.</span></span> <span data-ttu-id="3b397-141">旅行时间大约为9天–2.5，旅行时剩余时间为与。</span><span class="sxs-lookup"><span data-stu-id="3b397-141">The trip took about 9 days – 2.5 for travel, the rest for filming.</span></span> <span data-ttu-id="3b397-142">针对 Machu Picchu 的 (我们选择不执行侦察行程，预先研究并为与的几天时间 ) 。</span><span class="sxs-lookup"><span data-stu-id="3b397-142">(For Machu Picchu we opted not to do a scout trip, researching in advance and booking a few days of buffer for filming.)</span></span>

<span data-ttu-id="3b397-143">在罗马期间，团队会为每个区域拍摄照片并记下一些有趣的事实，还会有一些值得注意的问题，例如，在每个位置上旅行的难度，以及由于 crowds 或限制而导致胶片的难度。</span><span class="sxs-lookup"><span data-stu-id="3b397-143">While in Rome, the team took photos of each area and noted interesting facts as well as practical considerations, such as how hard it is to travel to each spot and how difficult it would be to film because of crowds or restrictions.</span></span> <span data-ttu-id="3b397-144">这可能听起来像度假，但却很多。</span><span class="sxs-lookup"><span data-stu-id="3b397-144">This may sound like a vacation, but it’s a lot of work.</span></span> <span data-ttu-id="3b397-145">早上提前开始，将不会停止，直到晚上。</span><span class="sxs-lookup"><span data-stu-id="3b397-145">Days started early in the morning and would go non-stop until evening.</span></span> <span data-ttu-id="3b397-146">每夜，都将在西雅图上上传素材以供评审。</span><span class="sxs-lookup"><span data-stu-id="3b397-146">Each night, footage was uploaded for the team back in Seattle to review.</span></span> 

![我们的捕获将在罗马中进行。](images/holotour-filming-crew-rome-500px.jpg) 

<span data-ttu-id="3b397-148">我们的捕获将在罗马中进行。</span><span class="sxs-lookup"><span data-stu-id="3b397-148">Our capture crew in Rome.</span></span> 


<span data-ttu-id="3b397-149">在侦察行程完成后，将对实际的与进行最终计划。</span><span class="sxs-lookup"><span data-stu-id="3b397-149">After the scout trip was completed, a final plan was made for actual filming.</span></span> <span data-ttu-id="3b397-150">这需要一个详细列表，其中介绍了电影的工作时间、日期和时间。</span><span class="sxs-lookup"><span data-stu-id="3b397-150">This required a detailed list of where we were going to film, on what day, and at what time.</span></span> <span data-ttu-id="3b397-151">每日海外都是昂贵的，因此这些行程需要更高的效率。</span><span class="sxs-lookup"><span data-stu-id="3b397-151">Every day overseas is expensive, so these trips needed to be efficient.</span></span> <span data-ttu-id="3b397-152">我们以罗马的顺序预订了指南和处理程序，以帮助我们和在日落后从日出到一天的全天使用。</span><span class="sxs-lookup"><span data-stu-id="3b397-152">We booked guides and handlers in Rome to help us and fully used every day from before sunrise to after sunset.</span></span> <span data-ttu-id="3b397-153">为了使你感到满意，我们需要获得最佳素材。</span><span class="sxs-lookup"><span data-stu-id="3b397-153">We need to get the best footage possible in order to make you feel like you’re really there.</span></span>

### <a name="capturing-the-video"></a><span data-ttu-id="3b397-154">捕获视频</span><span class="sxs-lookup"><span data-stu-id="3b397-154">Capturing the video</span></span>

<span data-ttu-id="3b397-155">在捕获过程中执行几个简单的操作可以更方便地处理后处理问题。</span><span class="sxs-lookup"><span data-stu-id="3b397-155">Doing a few simple things during capture can make post-processing much easier.</span></span> <span data-ttu-id="3b397-156">例如，当你将多个照相机中的图像组合在一起时，最终会出现视觉对象，因为每个相机的视图略有不同。</span><span class="sxs-lookup"><span data-stu-id="3b397-156">For example, whenever you stitch together images from multiple cameras, you end up with visual artifacts because each camera has a slightly different view.</span></span> <span data-ttu-id="3b397-157">相机上的对象越近，视图间的差别越大，而装订项目就越大。</span><span class="sxs-lookup"><span data-stu-id="3b397-157">The closer objects are to the camera, the larger the difference between the views, and the larger the stitching artifacts will be.</span></span> <span data-ttu-id="3b397-158">下面是一个简单的方法来直观显示问题：使你的拇指正面朝上，只需一眼就能看到它。</span><span class="sxs-lookup"><span data-stu-id="3b397-158">Here's an easy way to visualize the problem: hold your thumb up in front of your face and look at it with only one eye.</span></span> <span data-ttu-id="3b397-159">立即切换眼睛。</span><span class="sxs-lookup"><span data-stu-id="3b397-159">Now switch eyes.</span></span> <span data-ttu-id="3b397-160">您将看到您的拇指显示为相对于背景。</span><span class="sxs-lookup"><span data-stu-id="3b397-160">You’ll see that your thumb appears to move relative to the background.</span></span> <span data-ttu-id="3b397-161">如果您从人脸上走着您的拇指，并重复试验，则您的拇指会显得更少。</span><span class="sxs-lookup"><span data-stu-id="3b397-161">If you hold your thumb further away from your face and repeat the experiment, your thumb will appear to move less.</span></span> <span data-ttu-id="3b397-162">这种明显的变动与我们所面临的缝合问题类似：你的眼睛（如相机）看不到完全相同的图像，因为它们之间用少许距离分隔。</span><span class="sxs-lookup"><span data-stu-id="3b397-162">That apparent movement is similar to the stitching problem we faced: Your eyes, like our cameras, don’t see the exact same image because they are separated by a little distance.</span></span>

<span data-ttu-id="3b397-163">因为在与时，要避免最坏的项目，而不是在后续处理中纠正它们，所以我们尝试使离照相机的人和东西离不上的时间变得更容易，因为这样可以避免需要缝合关闭对象。</span><span class="sxs-lookup"><span data-stu-id="3b397-163">Because it’s much easier to prevent the worst artifacts while filming than it is to correct them in post-processing, we tried to keep people and things far away from the camera in the hopes we could eliminate the need to stitch close-up objects.</span></span> <span data-ttu-id="3b397-164">围绕照相机保持很大的清除可能是在拍摄过程中遇到的最大挑战之一，我们不得不使其工作。</span><span class="sxs-lookup"><span data-stu-id="3b397-164">Maintaining a large clearing around our camera was probably one of the biggest challenges we had during shooting and we had to get creative to make it work.</span></span> <span data-ttu-id="3b397-165">使用本地指南是管理 crowds 的巨大帮助，但我们还发现，使用符号（有时也是小型圆锥或 bean 包）来标记与空间相当有效，尤其是因为我们只需要在每个位置获取少量的素材。</span><span class="sxs-lookup"><span data-stu-id="3b397-165">Working with local guides was a huge help in managing crowds, but we also found that using signs—and sometimes small cones or bean bags—to mark our filming space was reasonably effective, especially since we only needed to get a short amount of footage at each location.</span></span> <span data-ttu-id="3b397-166">获取良好捕获的最佳方式通常是在早上，在大多数人展示之前，只是在早上提前到达。</span><span class="sxs-lookup"><span data-stu-id="3b397-166">Often the best way to get a good capture was to just to arrive very early in the morning, before most people showed up.</span></span>

<span data-ttu-id="3b397-167">其他一些有用的捕获技术直接来自传统的电影实践。</span><span class="sxs-lookup"><span data-stu-id="3b397-167">Some other useful capture techniques come straight from traditional film practices.</span></span> <span data-ttu-id="3b397-168">例如，我们在所有相机上都使用了颜色更正卡，并捕获了以后可能需要的纹理和对象的参考照片。</span><span class="sxs-lookup"><span data-stu-id="3b397-168">For example, we used a color correction card on all of our cameras and captured reference photos of textures and objects we might need later.</span></span> 

![显示颜色更正卡的 Machu Picchu 的粗略剪切。](images/rough-cut-machu-picchu-500px.png)

<span data-ttu-id="3b397-170">在进行装订之前，Pantheon 素材的粗略剪切。</span><span class="sxs-lookup"><span data-stu-id="3b397-170">A rough cut of Pantheon footage before stitching.</span></span>

### <a name="processing-the-video"></a><span data-ttu-id="3b397-171">处理视频</span><span class="sxs-lookup"><span data-stu-id="3b397-171">Processing the video</span></span>

<span data-ttu-id="3b397-172">捕获360°内容只是第一步，需要进行大量处理才能将捕获的原始照相机素材转换为你在 HoloTour 中看到的最终资产。</span><span class="sxs-lookup"><span data-stu-id="3b397-172">Capturing 360° content is only the first step—a lot of processing is needed to convert the raw camera footage we captured into the final assets you see in HoloTour.</span></span> <span data-ttu-id="3b397-173">我们回到回家后，我们需要从14种不同的相机源拍摄视频，并将其转换为包含最少项目的单个连续视频。</span><span class="sxs-lookup"><span data-stu-id="3b397-173">Once we were back home we needed to take the video from 14 different camera feeds and turn it into a single continuous video with minimal artifacts.</span></span> <span data-ttu-id="3b397-174">我们的艺术团队使用多种工具来合并和修饰捕获的素材，我们开发了一个管道来尽可能优化处理。</span><span class="sxs-lookup"><span data-stu-id="3b397-174">Our art team used a number of tools to combine and polish the captured footage and we developed a pipeline to optimize the processing as much as possible.</span></span> <span data-ttu-id="3b397-175">这种素材必须拼接，颜色得到校正，然后才能消除分散的元素和项目，或者增加了生活和运动的补充口袋，而这一切都可以提高实际的效果。</span><span class="sxs-lookup"><span data-stu-id="3b397-175">The footage had to be stitched together, color corrected, and then composited to remove distracting elements and artifacts or to add supplemental pockets of life and motion, all with the goal to enhance that feeling of actually being there.</span></span>

![在进行装订之前，Pantheon 素材的粗略剪切。](images/rough-cut-pantheon-500px.png)

<span data-ttu-id="3b397-177">在进行装订之前，Pantheon 素材的粗略剪切。</span><span class="sxs-lookup"><span data-stu-id="3b397-177">A rough cut of Pantheon footage before stitching.</span></span> 


<span data-ttu-id="3b397-178">若要将视频汇聚在一起，我们使用了一个名为 [PTGui](https://www.ptgui.com/) 的工具，并将其集成到了处理管道中。</span><span class="sxs-lookup"><span data-stu-id="3b397-178">To stitch the videos together, we used a tool called [PTGui](https://www.ptgui.com/) and integrated it into our processing pipeline.</span></span> <span data-ttu-id="3b397-179">作为后期处理的一部分，我们从视频中提取了仍为帧的帧，并找到了一种对其中一帧非常适合的装订模式。</span><span class="sxs-lookup"><span data-stu-id="3b397-179">As part of post-processing we extracted still frames from our videos and found a stitching pattern that looked good for one of those frames.</span></span> <span data-ttu-id="3b397-180">然后，将该模式应用到一个自定义的插件，我们编写这种方式，让我们的视频艺术家可以在组合后直接调整和调整装订模式。</span><span class="sxs-lookup"><span data-stu-id="3b397-180">We then applied that pattern to a custom plugin we wrote that allowed our video artists to fine tune and tweak the stitching pattern directly while compositing in After Effects.</span></span> 

![显示拼接 Pantheon 素材的 PTGui 屏幕截图。](images/stitching-tool-pantheon-500px.png)

<span data-ttu-id="3b397-182">显示拼接 Pantheon 素材的 PTGui 屏幕截图。</span><span class="sxs-lookup"><span data-stu-id="3b397-182">Screenshot of PTGui showing the stitched Pantheon footage.</span></span> 


### <a name="video-playback"></a><span data-ttu-id="3b397-183">视频播放</span><span class="sxs-lookup"><span data-stu-id="3b397-183">Video playback</span></span>

<span data-ttu-id="3b397-184">完成对素材的处理后，会获得一个无缝视频，但这种情况并不太大，而是围绕8K 的分辨率。</span><span class="sxs-lookup"><span data-stu-id="3b397-184">After processing of the footage is completed, we have a seamless video but it’s extraordinarily large—around 8K resolution.</span></span> <span data-ttu-id="3b397-185">解码视频非常昂贵，并且很少有计算机可以处理8K 视频，因此，下一个难题是查找在 HoloLens 上播放此视频的方式。</span><span class="sxs-lookup"><span data-stu-id="3b397-185">Decoding video is expensive and there are very few computers that can handle an 8K video so the next challenge was finding a way to play this video back on HoloLens.</span></span> <span data-ttu-id="3b397-186">我们开发了多种策略来避免解码成本，同时还使用户看起来像是查看整个视频。</span><span class="sxs-lookup"><span data-stu-id="3b397-186">We developed a number of strategies to avoid the cost of decoding while still making the user feel like they were viewing the entire video.</span></span>

<span data-ttu-id="3b397-187">最简单的优化是避免对不会更改的视频部分进行解码。</span><span class="sxs-lookup"><span data-stu-id="3b397-187">The easiest optimization is to avoid decoding parts of the video that don’t change much.</span></span> <span data-ttu-id="3b397-188">我们编写了一个工具，用于识别每个场景中几乎有无运动的区域。</span><span class="sxs-lookup"><span data-stu-id="3b397-188">We wrote a tool to identify areas in each scene that have little or no motion.</span></span> <span data-ttu-id="3b397-189">对于这些区域，我们会显示静态图像，而不是每个帧解码视频。</span><span class="sxs-lookup"><span data-stu-id="3b397-189">For those regions we show a static image rather than decoding a video each frame.</span></span> <span data-ttu-id="3b397-190">为此，我们将大的视频分为多个较小的块。</span><span class="sxs-lookup"><span data-stu-id="3b397-190">To make this possible, we divided up the massive video into much smaller chunks.</span></span>

<span data-ttu-id="3b397-191">我们还确保我们解码的每个像素都已最有效地使用。</span><span class="sxs-lookup"><span data-stu-id="3b397-191">We also made sure that every pixel we decoded was used most effectively.</span></span> <span data-ttu-id="3b397-192">我们 vspackage 压缩技术来减小视频的大小;我们根据要投影到的几何图形的多边形拆分视频区域;我们根据所包含的不同多边形的详细程度调整了 Uv-11 和 repacked 视频。</span><span class="sxs-lookup"><span data-stu-id="3b397-192">We experimented with compression techniques to lower the size of the video; we split the video regions according to the polygons of the geometry it would be projected onto; we adjusted UVs and repacked the videos based on how much detail different polygons included.</span></span> <span data-ttu-id="3b397-193">这样做的结果是，在单个8k 视频变成了多个块的情况下启动的内容，直到将它们正确地重新投影到场景中为止。</span><span class="sxs-lookup"><span data-stu-id="3b397-193">The result of this work is that what started as a single 8k video turned into many chunks that look almost unintelligible until they are properly re-projected into the scene.</span></span> <span data-ttu-id="3b397-194">对于理解纹理映射和 UV 封装的游戏开发人员，这可能很熟悉。</span><span class="sxs-lookup"><span data-stu-id="3b397-194">For a game developer who understands texture mapping and UV packing, this will probably look familiar.</span></span> 

![优化前 Pantheon 的完整视图。](images/pantheon-before-optimization-500px.png) 

<span data-ttu-id="3b397-196">优化前 Pantheon 的完整视图。</span><span class="sxs-lookup"><span data-stu-id="3b397-196">A full view of the Pantheon before optimizations.</span></span> 


![Pantheon 的右半部分，处理视频播放。](images/pantheon-process-video-playback-500px.png) 

<span data-ttu-id="3b397-198">Pantheon 的右半部分，处理视频播放。</span><span class="sxs-lookup"><span data-stu-id="3b397-198">The right half of the Pantheon, processed for video playback.</span></span> 


![优化和打包后单个视频区域的示例。](images/single-video-region-after-optimization-500px.png) 

<span data-ttu-id="3b397-200">优化和打包后单个视频区域的示例。</span><span class="sxs-lookup"><span data-stu-id="3b397-200">Example of a single video region after optimization and packing.</span></span> 


<span data-ttu-id="3b397-201">我们使用的另一种技巧是避免对不是主动查看的视频解码。</span><span class="sxs-lookup"><span data-stu-id="3b397-201">Another trick we used was to avoid decoding video you aren’t actively viewing.</span></span> <span data-ttu-id="3b397-202">在 HoloTour 中，在任何给定时刻，只能查看部分完整场景。</span><span class="sxs-lookup"><span data-stu-id="3b397-202">While in HoloTour, you can only see part of the full scene at any given moment.</span></span> <span data-ttu-id="3b397-203">我们仅在 FOV)  (的视图范围内或不久内解码视频。</span><span class="sxs-lookup"><span data-stu-id="3b397-203">We only decode videos within or shortly outside of your field of view (FOV).</span></span> <span data-ttu-id="3b397-204">旋转头时，我们开始播放 FOV 中的视频区域，并停止播放其中不再存在的视频区域。</span><span class="sxs-lookup"><span data-stu-id="3b397-204">As you rotate your head, we start playing the regions of the video that are now in your FOV and stop playing ones that are no longer within it.</span></span> <span data-ttu-id="3b397-205">大多数人都不会注意到这种情况，但如果您迅速翻了，您将看到视频需要一秒钟的时间，在这种情况下，您将看到一个静态图像，该图像随后会在视频准备就绪后淡回到视频。</span><span class="sxs-lookup"><span data-stu-id="3b397-205">Most people won’t even notice this is happening, but if you turn around rapidly, you’ll see the video takes a second to start— in the meantime you’ll see a static image which then fades back to video once it’s ready.</span></span>

<span data-ttu-id="3b397-206">为实现此策略，我们开发了大量视频播放系统。</span><span class="sxs-lookup"><span data-stu-id="3b397-206">To make this strategy work we developed an extensive video playback system.</span></span> <span data-ttu-id="3b397-207">我们优化了低级播放代码，使视频切换功能极为高效。</span><span class="sxs-lookup"><span data-stu-id="3b397-207">We optimized the low level playback code in order to make video switching extremely efficient.</span></span> <span data-ttu-id="3b397-208">此外，我们还必须以一种特殊的方式对我们的视频进行编码，以便随时可以快速切换到任何视频。</span><span class="sxs-lookup"><span data-stu-id="3b397-208">Additionally, we had to encode our videos in a special way to make it possible to rapidly switch to any video at any time.</span></span> <span data-ttu-id="3b397-209">此播放管道需要大量的开发时间，因此我们分阶段实现。</span><span class="sxs-lookup"><span data-stu-id="3b397-209">This playback pipeline took a significant amount of development time so we implemented it in stages.</span></span> <span data-ttu-id="3b397-210">我们开始时使用的是一个更简单的系统，但允许的设计人员和艺术家能处理体验，并使其变得更可靠，使我们能够通过最终质量栏提供。</span><span class="sxs-lookup"><span data-stu-id="3b397-210">We started with a simpler system that was less efficient, but allowed designers and artists to work on the experience, and slowly improved it to a more robust playback system that allowed us to ship at the final quality bar.</span></span> <span data-ttu-id="3b397-211">此最终系统包含我们在 Unity 中创建的自定义工具，用于设置场景中的视频和监视播放引擎。</span><span class="sxs-lookup"><span data-stu-id="3b397-211">This final system had custom tools we created within Unity to set up the video within the scene and monitor the playback engine.</span></span>

### <a name="recreating-near-space-objects-in-3d"></a><span data-ttu-id="3b397-212">在三维中重新创建近空间对象</span><span class="sxs-lookup"><span data-stu-id="3b397-212">Recreating near-space objects in 3D</span></span>

<span data-ttu-id="3b397-213">视频构成了你在 HoloTour 中看到的大部分内容，但有许多三维对象出现在靠近你的范围内，例如在 Piazza Navona 中进行绘制，Pantheon 外的 fountain，或者你为高空场景提供的热气球。</span><span class="sxs-lookup"><span data-stu-id="3b397-213">Videos make up the majority of what you see in HoloTour, but there are a number of 3D objects that appear close to you, such as the painting in Piazza Navona, the fountain outside the Pantheon, or the hot air balloon you stand in for aerial scenes.</span></span> <span data-ttu-id="3b397-214">这些3D 对象非常重要，因为人机深度认知非常好地靠近，而不是太好了。</span><span class="sxs-lookup"><span data-stu-id="3b397-214">These 3D objects are important because human depth perception is very good up close, but not very good far away.</span></span> <span data-ttu-id="3b397-215">我们可以在远处远离视频，但为了使用户能够浏览其空间，并使其看起来像是真正的，附近的对象需要深度。</span><span class="sxs-lookup"><span data-stu-id="3b397-215">We can get away with video in the distance, but to allow users to walk around their space and feel like they’re really there, nearby objects need depth.</span></span> <span data-ttu-id="3b397-216">此方法类似于你可能在自然历史记录博物馆中看到的内容，例如，在前台使用具有物理 landscaping、植物和动物 specimens 的 diorama，但 recedes 进入背景中的巧妙屏蔽的遮罩绘图。</span><span class="sxs-lookup"><span data-stu-id="3b397-216">This technique is similar to the sort of thing you might see in a natural history museum—picture a diorama that has physical landscaping, plants, and animal specimens in the foreground, but recedes into a cleverly masked matte painting in the background.</span></span>

<span data-ttu-id="3b397-217">某些对象只是我们创建并添加到场景中的3D 资产，旨在增强体验。</span><span class="sxs-lookup"><span data-stu-id="3b397-217">Some objects are simply 3D assets we created and added to the scene to enhance the experience.</span></span> <span data-ttu-id="3b397-218">绘图和热气球落在此类别中，因为我们 filmed 时它们不存在。</span><span class="sxs-lookup"><span data-stu-id="3b397-218">The painting and the hot air balloon fall into this category because they weren’t present when we filmed.</span></span> <span data-ttu-id="3b397-219">与游戏资产类似，它们是由团队中的3D 艺术家创建的，并相应地纹理。</span><span class="sxs-lookup"><span data-stu-id="3b397-219">Similar to game assets, they were created by a 3D artist on our team and textured appropriately.</span></span> <span data-ttu-id="3b397-220">我们将它们放在离您的位置附近的场景中，游戏引擎可以将其呈现给两个 HoloLens 显示器，使其显示为三维对象。</span><span class="sxs-lookup"><span data-stu-id="3b397-220">We place these in our scenes near where you stand, and the game engine can render them to the two HoloLens displays so that they appear as a 3D object.</span></span>

<span data-ttu-id="3b397-221">其他资产（如 Pantheon 外的 fountain）是存在于我们的视频的位置的实际对象，但若要将这些对象移出视频和3D，我们必须执行一些操作。</span><span class="sxs-lookup"><span data-stu-id="3b397-221">Other assets, like the fountain outside the Pantheon, are real objects that exist in the locations where we're shooting video, but to bring these objects out of the video and into 3D, we have to do a number of things.</span></span>

<span data-ttu-id="3b397-222">首先，我们需要有关每个对象的其他信息。</span><span class="sxs-lookup"><span data-stu-id="3b397-222">First, we need additional information about each object.</span></span> <span data-ttu-id="3b397-223">在与的位置上，我们的团队捕获了这些对象的很多参考资料，以便我们有足够的详细图像来准确地重新创建纹理。</span><span class="sxs-lookup"><span data-stu-id="3b397-223">While on location for filming, our team captured a lot of reference footage of these objects so that we would have enough detailed images to accurately recreate the textures.</span></span> <span data-ttu-id="3b397-224">此团队还执行了 [photogrammetry](https://en.wikipedia.org/wiki/Photogrammetry) 扫描，该扫描从数十个2d 图像构造一个3d 模型，为我们提供了理想规模的对象模型。</span><span class="sxs-lookup"><span data-stu-id="3b397-224">The team also performed a [photogrammetry](https://en.wikipedia.org/wiki/Photogrammetry) scan, which constructs a 3D model from dozens of 2D images, giving us a rough model of the object at perfect scale.</span></span>

<span data-ttu-id="3b397-225">处理素材时，会从视频中删除以后将替换为3D 表示形式的对象。</span><span class="sxs-lookup"><span data-stu-id="3b397-225">As we process our footage, objects that will later be replaced with a 3D representation are removed from the video.</span></span> <span data-ttu-id="3b397-226">3D 资产基于 photogrammetry 模型，但由我们的艺术家进行了清理和简化。</span><span class="sxs-lookup"><span data-stu-id="3b397-226">The 3D asset is based on the photogrammetry model but cleaned up and simplified by our artists.</span></span> <span data-ttu-id="3b397-227">对于某些对象，我们可以使用视频的某些部分（例如 fountain 上的水纹理），但大多数 fountain 现在都是3D 对象，这使用户可以在体验范围内发现深度并浏览。</span><span class="sxs-lookup"><span data-stu-id="3b397-227">For some objects, we can use parts of the video—such as the water texture on the fountain—but most of the fountain is now a 3D object, which allows users to perceive depth and walk around it in a limited space in the experience.</span></span> <span data-ttu-id="3b397-228">这种接近空间的对象大大增加了真实意义，并有助于在虚拟位置中使用户接地。</span><span class="sxs-lookup"><span data-stu-id="3b397-228">Having near-space objects like this greatly adds to the sense of realism and helps to ground the users in the virtual location.</span></span> 

![删除 fountain 的 Pantheon 素材。](images/object-removal-pantheon-500px.png)

<span data-ttu-id="3b397-231">删除 fountain 的 Pantheon 素材。</span><span class="sxs-lookup"><span data-stu-id="3b397-231">Pantheon footage with the fountain removed.</span></span> <span data-ttu-id="3b397-232">它将替换为3D 资产。</span><span class="sxs-lookup"><span data-stu-id="3b397-232">It will be replaced with a 3D asset.</span></span>


## <a name="final-thoughts"></a><span data-ttu-id="3b397-233">结束语</span><span class="sxs-lookup"><span data-stu-id="3b397-233">Final thoughts</span></span>

<span data-ttu-id="3b397-234">很明显，创建此内容比我们在此处讨论的内容更多。</span><span class="sxs-lookup"><span data-stu-id="3b397-234">Obviously, there was more to creating this content than what we've discussed here.</span></span> <span data-ttu-id="3b397-235">有几种场景：我们喜欢 "可能的透视"，其中包括热气球的 gladiator 和 Colosseum 中的 ""，这种方法更具创造性。</span><span class="sxs-lookup"><span data-stu-id="3b397-235">There are a few scenes—we like to call them "impossible perspectives"—including the hot air balloon ride and the gladiator fight in the Colosseum, which took a more creative approach.</span></span> <span data-ttu-id="3b397-236">我们将在将来的案例研究中解决这些情况。</span><span class="sxs-lookup"><span data-stu-id="3b397-236">We'll address these in a future case study.</span></span>

<span data-ttu-id="3b397-237">我们希望在生产过程中，将解决方案共享到一些更大的挑战对于其他开发人员非常有用，并且您可以使用其中一些技术来创建您自己的 HoloLens 体验。</span><span class="sxs-lookup"><span data-stu-id="3b397-237">We hope that sharing solutions to some of the bigger challenges we had during production is helpful to other developers and that you're inspired to use some of these techniques to create your own immersive experiences for HoloLens.</span></span> <span data-ttu-id="3b397-238"> (如果你这样做，请确保在 [HoloLens 应用开发论坛](https://forums.hololens.com/)上与我们分享！ ) </span><span class="sxs-lookup"><span data-stu-id="3b397-238">(And if you do, please make sure to share it with us on the [HoloLens App Development forum](https://forums.hololens.com/)!)</span></span>

## <a name="about-the-authors"></a><span data-ttu-id="3b397-239">关于作者</span><span class="sxs-lookup"><span data-stu-id="3b397-239">About the authors</span></span>

<table style="border:0">
<tr>
<td style="border:0" width="60px"> <img alt="David Haley" width="60" height="60" src="images/haley.png" /></td>
<td style="border:0" width="408"> <span data-ttu-id="3b397-240"><b>David Haley</b> 是一名高级开发人员，他们已经了解了有关照相机 rig 和视频播放的详细信息，而不是在 HoloTour 上使用。</span><span class="sxs-lookup"><span data-stu-id="3b397-240"><b>David Haley</b> is a Senior Developer who learned more about camera rigs and video playback than he thought possible from working on HoloTour.</span></span></td>
<td style="border:0" width="60px"> <img alt="Danny Askew" width="60" height="60" src="images/askew.png" /></td>
<td style="border:0" width="408"> <span data-ttu-id="3b397-241"><b>Danny Askew</b> 是一位视频音乐家，可确保您通过罗马的旅程尽可能完美。</span><span class="sxs-lookup"><span data-stu-id="3b397-241"><b>Danny Askew</b> is a Video Artist who made sure your journey through Rome was as flawless as possible.</span></span></td>
</tr>
<tr>
<td style="border:0" width="60px"> <img alt="Jason Syltebo" width="60" height="60" src="images/syltebo.png" /></td>
<td style="border:0" width="408"> <span data-ttu-id="3b397-242"><b>Jason Syltebo</b> 是一种音频设计人员，它可以确保你访问的每个目标的 soundscape，即使在你返回时也是如此。</span><span class="sxs-lookup"><span data-stu-id="3b397-242"><b>Jason Syltebo</b> is an Audio Designer who made sure you could experience the soundscape of every destination you visit, even when you go back in time.</span></span></td>
<td style="border:0" width="60px"> <img alt="Travis Steiner" width="60" height="60" src="images/steiner.png" /></td>
<td style="border:0" width="408"> <span data-ttu-id="3b397-243"><b>Travis Steiner</b> 是一位设计主管，在站点上研究和 scouted 位置、创建行程计划和定向的与。</span><span class="sxs-lookup"><span data-stu-id="3b397-243"><b>Travis Steiner</b> is a Design Director who researched and scouted locations, created trip plans, and directed filming on site.</span></span></td>
</tr>
</table>



## <a name="see-also"></a><span data-ttu-id="3b397-244">请参阅</span><span class="sxs-lookup"><span data-stu-id="3b397-244">See also</span></span>
* [<span data-ttu-id="3b397-245">视频： Microsoft HoloLens： HoloTour</span><span class="sxs-lookup"><span data-stu-id="3b397-245">Video: Microsoft HoloLens: HoloTour</span></span>](https://www.youtube.com/watch?v=pLd9WPlaMpY)
